{product-title} supports operating with the OpenStack `admin` tenant.
When creating an OpenStack provider in {product-title}, select the OpenStack provider's `admin` user because it is the default administrator of the OpenStack `admin` tenant.
When using the `admin` credentials, a user in {product-title} provisions into the `admin` tenant, and sees images, networks, and instances that are associated with the `admin` tenant.


[NOTE]
====
In OpenStack, you must add `admin` as a member of all tenants that users want to access and use in {product-title_short}.

See  https://access.redhat.com/documentation/en-us/red_hat_cloudforms/4.7/html-single/deployment_planning_guide/#tenants[Tenancy] in the _Deployment Planning Guide_ for more details on tenancy in {product-title_short}.
====

include::tenant-mapping.adoc[]


[NOTE]
=====
You can set whether {product-title} should use the Telemetry service or Advanced Message Queueing Protocol (AMQP) for event monitoring. If you choose Telemetry, you should first configure the *ceilometer* service on the overcloud to store events. See xref:openstack-events-oc[] for instructions.

For more information, see https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/11/html/architecture_guide/components#comp-telemetry[OpenStack Telemetry (ceilometer)] in the Red Hat OpenStack Platform _Architecture Guide_.
=====

[NOTE]
====
To authenticate the provider using a self-signed Certificate Authority (CA), configure the {product-title_short} appliance to trust the certificate using the steps in  xref:app-self_signed_CA[] before adding the provider.
====

. Navigate to menu:Compute[Clouds > Providers].

. Click  image:1847.png[] (*Configuration*), then click  image:1862.png[] (*Add a New Cloud Provider*).

. Enter a *Name* for the provider.

. From the *Type* list, select *OpenStack*.

. Select the appropriate *API Version* from the list. The default is `Keystone v2`.
+
If you select `Keystone v3`, enter the `Keystone V3 Domain ID` that {product-title} should use. This is the domain of the user account you will be specifying later in the *Default* tab. If domains are not configured in the provider, enter *default*.
+
[NOTE]
====
Keystone API v3 is required to create cloud tenants on OpenStack cloud providers.
====
+
[NOTE]
=========
include::osp-keystone-api-v3.adoc[]
=========
+
. Enter a region number in *Region*.

. Enter the appropriate *Zone* for the provider. If you do not specify a zone, it is set to `default`. 

. (Optional) Enable tenant mapping by toggling the *Tenant Mapping Enabled* option to *Yes*. This synchronizes resources and users between the OpenStack cloud provider and {product-title_short}. By default, tenant mapping is disabled.

. Select the appropriate *Zone* for the provider. By default, the zone is set to *default*.
+
NOTE: For more information, see the definition of host aggregates and availability zones in https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/11/html/architecture_guide/components#comp-compute[OpenStack Compute (nova)] in the Red Hat OpenStack Platform _Architecture Guide_.

. In the *Default* tab, under *Endpoints*, configure the host and authentication details of your OpenStack provider:
.. Select a *Security Protocol* method to specify how to authenticate the provider:
* *SSL without validation*: Authenticate the provider insecurely using SSL.
* *SSL*: Authenticate the provider securely using a trusted Certificate Authority. Select this option if the provider has a valid SSL certificate and it is signed by a trusted Certificate Authority. No further configuration is required for this option. This is the recommended authentication method.
* *Non-SSL*: Connect to the provider insecurely using only HTTP protocol, without SSL.
.. In *Hostname (or IPv4 or IPv6 address)*, enter the public IP or fully qualified domain name of the OpenStack Keystone service. 
+
NOTE: The hostname required here is also the *OS_AUTH_URL* value in the *~/overcloudrc* file generated by the director (see https://access.redhat.com/documentation/en-us/red_hat_openstack_platform/11/html-single/director_installation_and_usage/#sect-Accessing_the_Overcloud[Accessing the Overcloud] in Red Hat OpenStack Platform _Director Installation and Usage_), or the *~/keystonerc_admin* file generated by Packstack (see https://access.redhat.com/articles/1127153[Evaluating OpenStack: Single-Node Deployment]).
.. In *API Port*, set the public port used by the OpenStack Keystone service. By default, OpenStack uses port 5000 for non-SSL security protocol. For SSL, API port is 13000 by default.
.. In the *Username* field, enter the name of a user in the OpenStack environment.
+
[IMPORTANT]
====
In environments that use Keystone v3 authentication, the user must have the *admin* role for the relevant domain.
====
+
.. In the *Password* field, enter the password for the user.
.. Click *Validate* to confirm {product-title} can connect to the OpenStack provider.

. Next, configure how {product-title} should receive events from the OpenStack provider. Click the *Events* tab in the *Endpoints* section to start.
* To use the Telemetry service of the OpenStack provider, select *Ceilometer*. Before you do so, the provider must first be configured accordingly. See xref:openstack-events-oc[] for details.
* If you prefer to use the AMQP Messaging bus instead, or eventing is not enabled on Ceilometer, select *AMQP* and configure the following:
.. Select a *Security Protocol* method.
.. In *Hostname (or IPv4 or IPv6 address)* (of the *Events* tab, under *Endpoints*), enter the public IP or fully qualified domain name of the AMQP host.
.. In the *API Port*, set the public port used by AMQP. By default, OpenStack uses port 5672 for this.
.. In the *Username* field, enter the name of an OpenStack user with privileged access (for example, *admin*). Then, provide its corresponding password in the *Password* field.
.. Click *Validate* to confirm the credentials.
. Click *Add* after configuring the cloud provider.

[NOTE]
====
 * To collect inventory and metrics from an OpenStack environment, the {product-title} appliance requires that the adminURL endpoint for the OpenStack environment be on a non-private network.
Hence, the OpenStack adminURL endpoint should be assigned an IP address other than `192.168.x.x`. Additionally, all the Keystone endpoints must be accessible, otherwise refresh will fail.
* Collecting capacity and utilization data from an OpenStack cloud provider requires selecting the *Collect for All Clusters* option under *Configuration*, in the settings menu. For information, see  https://access.redhat.com/documentation/en-us/red_hat_cloudforms/4.5/html-single/general_configuration/#capacity-and-utilization-collections[Capacity and Utilization Collections] in the _General Configuration Guide_.
====  

