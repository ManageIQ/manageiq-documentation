<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "../Installing_CloudForms_on_Red_Hat_Enterprise_Virtualization.ent">
%BOOK_ENTITIES;
]>
<section id="Configuring_an_External_Database" remap="TID_26332">
	<title>Configuring an External Database</title>
	<para>
		The <filename>postgresql.conf</filename> file used with CloudForms Management Engine databases requires specific settings for correct operation. For example, it must correctly reclaim table space, control session timeouts, and format the PostgreSQL server log for improved system support. Due to these requirements, Red Hat recommends that external CloudForms Management Engine databases use a <filename>postgresql.conf</filename> file based on the standard file used by the CloudForms Management Engine appliance.
	</para>
	<para>
		Ensure you configure the settings in the <filename>postgresql.conf</filename> to suit your system. For example, customize the <code>shared_buffers</code> setting according to the amount of real storage available in the external system hosting the PostgreSQL instance. In addition, depending on the aggregate number of appliances expected to connect to the PostgreSQL instance, it may be necessary to alter the <code>max_connections</code> setting.
	</para>
	<para>
		Because the <filename>postgresql.conf</filename> file controls the operation of all databases managed by a single instance of PostgreSQL, do not mix CloudForms Management Engine databases with other types of databases in a single PostgreSQL instance.
	</para>
	<note>
		<para>
			CloudForms Management Engine 3.x requires PostgreSQL version 9.2.4.
		</para>
	</note>
	<procedure>
		<title>To Configure a CloudForms Management Engine External Database</title>
		<step>
			<para>
				Start up the appliance and open a terminal console from your virtualization or cloud provider.
			</para>
		</step>
		<step>
			<para>
				The login screen appears:
			</para>
			<screen>To administer this appliance, browse to https://192.168.0.40/

Username:</screen>
			<para>
				Enter the administration username and password.
			</para>
		</step>
		<step>
			<para>
				The status screen appears and displays details about the CloudForms Management Engine Appliance. Press <userinput> Enter </userinput> to change to the configuration menu.
			</para>
		</step>
		<step>
			<para>
				Select <userinput> 8) Configure Database </userinput> from the menu.
			</para>
		</step>
		<step>
			<para>
				You are prompted to create or fetch a security key.
			</para>
			<itemizedlist>
				<listitem>
					<para>
						If this is the first CFME appliance, select the option to create a key.
					</para>
				</listitem>
				<listitem>
					<para>
						If this is not the first CFME appliance, select the option to fetch the key from the first CFME appliance. All CFME appliances in a multi-region deployment must use the same key.
					</para>
				</listitem>
			</itemizedlist>
		</step>
		<step>
			<para>
				Choose <userinput> 2) External </userinput> for the database location.
			</para>
		</step>
		<step>
			<para>
				Enter the database hostname or IP address when prompted.
			</para>
		</step>
		<step>
			<para>
				Enter the database name or leave blank for the default (<literal>vmdb_production</literal>).
			</para>
		</step>
		<step>
			<para>
				Enter the database username or leave blank for the default (<literal>root</literal>).
			</para>
		</step>
		<step>
			<para>
				Enter the chosen database user's password.
			</para>
		</step>
		<step>
			<para>
				Confirm the configuration if prompted.
			</para>
		</step>
	</procedure>
	<formalpara>
		<title>Result:</title>
		<para>
			CloudForms Management Engine configures the external database.
		</para>
	</formalpara>
</section>
