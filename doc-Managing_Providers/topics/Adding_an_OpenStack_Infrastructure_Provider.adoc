= Adding an OpenStack Infrastructure Provider

After initial installation and creation of a CloudForms Management Engine environment, add an OpenStack Infrastructure provider to the appliance. 

. Navigate to menu:Infrastructure[Providers]. 
. Click  image:images/1847.png[] btn:[(Configuration)], then click  image:images/1848.png[]btn:[(Add a New Infrastructure Provider)]. 
. Enter the [label]#Name# of the provider to add.
  The [label]#Name# is how the device is labeled in the console. 
. Select [label]#OpenStack Infrastructure# from the [label]#Type# list. 
. Enter the [label]#Host Name (or IPv4 or IPv6 address)# of the provider. 
+
IMPORTANT: The [label]#Host Name# must use a unique fully qualified domain name. 

. Enter the [label]#API Port# of your Keystone service.
  The default port is [literal]+5000+. 
+
IMPORTANT: If the Keystone service is configured to use SSL, you must enter the SSL port for Keystone. 

. Select the appropriate [label]#Zone# for the provider.
  By default, the zone is set to [label]#default#. 
. In the [label]#Credentials# area, under [label]#Default#, provide the login credentials required for the OpenStack Infrastructure administrative user: 
+
* Enter the user name in the [label]#User ID# field. 
* Enter the user password in the [label]#Password# field. 
* Confirm the user password in the [label]#Verify Password# field. 
* Click [label]#Validate# to confirm that the CloudForms Management Engine can connect to the OpenStack Infrastructure instance using the user name and password. 

. In the [label]#Credentials# area, under [label]#AMQP#, provide the login credentials required for the Advanced Message Queuing Protocol messaging service: 
+
* Enter the administrative user name in the [label]#User ID# field. 
* Enter the user password in the [label]#Password# field. 
* Confirm the user password in the [label]#Verify Password# field. 
* Click [label]#Validate# to confirm that the CloudForms Management Engine can connect to the messaging service using the user name and password. 

. In the [label]#Credentials# area, under [label]#RSA key pair#, provide the user name and private key required to connect via SSH to all hosts in the provider: 
+
* Enter the administrative user name in the [label]#User ID# field. 
* Enter the private key from the machine on which OpenStack was deployed in the [label]#Private Key# field. 

. Click [label]#Save#. 

NOTE: CloudForms Management Engine requires that the adminURL endpoint for all OpenStack services be on a non-private network.
Accordingly, assign the adminURL endpoint an IP address of something other than [literal]+192.168.x.x+.
The adminURL endpoint must be accessible to the CFME Appliance that is responsible for collecting inventory and gathering metrics from the OpenStack environment.

[NOTE]
======
For Red Hat CloudForms to be able to receive events from a Red Hat OpenStack provider, the OpenStack configuration file must be modified. Specifically, the [label]#notification_driver# field must be defined.

For Nova and Heat, in order to start getting notifications, manually change the configuration files as below and restart services.

------
/etc/heat/heat.conf
notification_driver=glance.openstack.common.notifier.rpc_notifier
notification_topics=notifications
------

------
/etc/nova/nova.conf
notification_driver=messaging
notification_topics=notifications
------
======

