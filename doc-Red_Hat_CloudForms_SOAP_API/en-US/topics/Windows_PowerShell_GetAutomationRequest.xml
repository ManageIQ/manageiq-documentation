<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "../Red_Hat_CloudForms_SOAP_API.ent">
%BOOK_ENTITIES;
]>
<section id="Windows_PowerShell_GetAutomationRequest" remap="TID_14692">
	<title>Windows PowerShell: GetAutomationRequest</title>
	<programlisting>
<![CDATA[
[System.Net.ServicePointManager]::ServerCertificateValidationCallback = { $true }
$ip = "https://evm_appl_address"
$userid, $password = "admin", "smartvm"
$cred = New-Object System.Management.Automation.PsCredential $userid, (convertto-securestring $password -asplaintext -force)

trap {Write-Host $Error[0]; break}

$Error.Clear()
Write-Host "Connecting to EVM integrate web-services at $($ip)/vmdbws/wsdl"
$miqvmdb = New-WebServiceProxy -uri "$($ip)/vmdbws/wsdl" -Credential $cred -ErrorAction Stop -Namespace VmdbWs
Write-Host "Successfully connected to EVM integrate web-services"

################
#
# Parameter1 - request
#
################
$request = @()
$request += "9"
$request = [string]::join("|", $request)

$result = $miqvmdb.GetAutomationRequest($request)
Write-Host "Results:" 
$result |fl

Write-Host "done"
]]>
</programlisting>
</section>