<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "Methods_Available_for_Automation.ent">
%BOOK_ENTITIES;
]>
<chapter id="chap-Methods_Available_for_Use_with_CloudForms_Management_Engine">
	<title>Methods Available for Use with CloudForms Management Engine</title> 
	<para>
		Methods can be used from within CloudForms Management Engine to create custom actions and workflows for the objects managed for your CloudForms Management Engine Infrastructure. This document describes the methods available for use in CloudForms Management Engine. This document is organized by the object hierarchy in the Automate Model.
	</para>
	<xi:include href="topics/About_evm.root.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Method_Hierarchy.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Base_Methods.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Availability_Zones_availability_zone.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Classifications_classification.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Cloud_Networks_cloud_network.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Cloud_Resource_Quotas_cloud_resource_quota.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Cloud_Subnets_cloud_subnet.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Cloud_Tenants_cloud_tenant.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Customization_template.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<section id="sect-Clusters_ems_cluster">
		<title>Clusters (ems_cluster)</title> 
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								all_resource_pools
							</para>
						</entry>
						<entry>
							<para>
								Return all of the objects Resource Pools
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								all_vms
							</para>
						</entry>
						<entry>
							<para>
								Return all of the objects Virtual Machines
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								default_resource_pool
							</para>
						</entry>
						<entry>
							<para>
								Return the objects default Resource Pool
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_events
							</para>
						</entry>
						<entry>
							<para>
								Returns an array of EmsEvent records associated with the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ext_management_system
							</para>
						</entry>
						<entry>
							<para>
								Return objects Management System
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								hosts
							</para>
						</entry>
						<entry>
							<para>
								Return objects Hosts
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								parent_folder
							</para>
						</entry>
						<entry>
							<para>
								Return objects Parent Folder
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								register_host(host)
							</para>
						</entry>
						<entry>
							<para>
								Register Host to this Cluster
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								resource_pools
							</para>
						</entry>
						<entry>
							<para>
								Return objects Resource Pools
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								storages
							</para>
						</entry>
						<entry>
							<para>
								Return objects datastores
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								vms
							</para>
						</entry>
						<entry>
							<para>
								Return objects Virtual Machines
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>  
		<programlisting language="Ruby">
<![CDATA[
  #########################
  #
  # Method: dumpCluster
  # Inputs: $evm.root['ems_cluster']
  # Description: Dump Cluster information
  #
  ##########################
  def dumpCluster(cluster)
    $evm.log("info","#{@log_prefix} - Cluster:<#{cluster.name}> Begin Attributes")
    cluster.attributes.sort.each { |k, v| $evm.log("info", "#{@log_prefix} - Cluster:<#{cluster.name}> Attributes - #{k}: #{v.inspect}")}
    $evm.log("info","#{@log_prefix} - Cluster:<#{cluster.name}> End Attributes")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Cluster:<#{cluster.name}> Begin Associations")
    cluster.associations.sort.each { |assc| $evm.log("info", "#{@log_prefix} - Cluster:<#{cluster.name}> Associations - #{assc}")}
    $evm.log("info","#{@log_prefix} - Cluster:<#{cluster.name}> End Associations")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Cluster:<#{cluster.name}> Begin Virtual Columns")
    cluster.virtual_column_names.sort.each { |vcn| $evm.log("info", "#{@log_prefix} - Cluster:<#{cluster.name}> Virtual Columns - #{vcn}: #{cluster.send(vcn)}")}
    $evm.log("info","#{@log_prefix} - Cluster:<#{cluster.name}> End Virtual Columns")
    $evm.log("info","")
  end
]]>
</programlisting>
	</section>
	<xi:include href="topics/Management_System_Events_ems_event.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Management_System_Folders_ems_folder.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<section id="sect-Providers_ext_management_system">
		<title>Providers (ext_management_system)</title> 
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								authentication_password_encrypted
							</para>
						</entry>
						<entry>
							<para>
								Returns credentials password encrypted
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								authentication_password
							</para>
						</entry>
						<entry>
							<para>
								Returns credentials password unencrypted
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								authentication_userid
							</para>
						</entry>
						<entry>
							<para>
								Returns credentials user id
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_clusters
							</para>
						</entry>
						<entry>
							<para>
								Returns objects clusters
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_events
							</para>
						</entry>
						<entry>
							<para>
								Returns an array of EmsEvent records associated with the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_folders
							</para>
						</entry>
						<entry>
							<para>
								Returns objects folders
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								hosts
							</para>
						</entry>
						<entry>
							<para>
								Returns objects hosts
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								refresh
							</para>
						</entry>
						<entry>
							<para>
								Refreshes relationships and power states for objects related to the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								resource_pools
							</para>
						</entry>
						<entry>
							<para>
								Returns objects resource pools
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								storages
							</para>
						</entry>
						<entry>
							<para>
								Returns objects storages
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								vms
							</para>
						</entry>
						<entry>
							<para>
								Returns objects vms
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								to_s
							</para>
						</entry>
						<entry>
							<para>
								Converts object to string
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<para />  
		<programlisting language="Ruby">
<![CDATA[
  #########################
  #
  # Method: dumpEMS
  # Inputs: $evm.root['ext_management_system']
  # Description: Dump EMS information
  #
  ##########################
  def dumpEMS(ems)
    $evm.log("info","#{@log_prefix} - EMS:<#{ems.name}> Begin Attributes")
    ems.attributes.sort.each { |k, v| $evm.log("info", "#{@log_prefix} - EMS:<#{ems.name}> Attributes - #{k}: #{v.inspect}")}
    $evm.log("info","#{@log_prefix} - EMS:<#{ems.name}> End Attributes")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - EMS:<#{ems.name}> Begin Associations")
    ems.associations.sort.each { |assc| $evm.log("info", "#{@log_prefix} - EMS:<#{ems.name}> Associations - #{assc}")}
    $evm.log("info","#{@log_prefix} - EMS:<#{ems.name}> End Associations")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - EMS:<#{ems.name}> Begin EMS Folders")
    ems.ems_folders.each { |ef| ef.attributes.sort.each { |k,v| $evm.log("info", "#{@log_prefix} - EMS:<#{ems.name}> EMS Folder:<#{ef.name}> #{k}: #{v.inspect}")}}
    $evm.log("info","#{@log_prefix} - EMS:<#{ems.name}> End EMS Folders")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - EMS:<#{ems.name}> Begin Virtual Columns")
    ems.virtual_column_names.sort.each { |vcn| $evm.log("info", "#{@log_prefix} - EMS:<#{ems.name}> Virtual Columns - #{vcn}: #{ems.send(vcn)}")}
    $evm.log("info","#{@log_prefix} - EMS:<#{ems.name}> End Virtual Columns")
    $evm.log("info","")
  end
]]>
</programlisting>
		<xi:include href="topics/Cloud_Providers_ems_cloud.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	</section>
	<xi:include href="topics/Firewall_Rules_firewall_rule.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Flavors_flavor.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Floating_IPs_floating_ip.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Guest_Applications_guest_application.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Guest_Device_guest_device.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Hardware_hardware.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<section id="sect-Hosts_host">
		<title>Hosts (host)</title> 
		<para />
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								authentication_password
							</para>
						</entry>
						<entry>
							<para>
								Returns credential password
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								authentication_userid
							</para>
						</entry>
						<entry>
							<para>
								Returns credential user
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								datacenter
							</para>
						</entry>
						<entry>
							<para>
								Returns datacenter
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								directories
							</para>
						</entry>
						<entry>
							<para>
								Returns list of directories for the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								domain
							</para>
						</entry>
						<entry>
							<para>
								Returns the domain portion of the hostname
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_cluster
							</para>
						</entry>
						<entry>
							<para>
								Returns cluster
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_events
							</para>
						</entry>
						<entry>
							<para>
								Returns an array of EmsEvent records associated with the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_folder
							</para>
						</entry>
						<entry>
							<para>
								Returns hosts folder on Management System
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								event_log_threshold?(options)
							</para>
						</entry>
						<entry>
							<para>
								Searches event log records to determine if an event has occurred x number of times within a defined time frame. Returns true if the number of matching records found are greater or equal to the specified freq_threshold, otherwise it returns false
							</para>
							<para />
							<para>
								Options values:
							</para>
							<para>
								:message_filter_type - Must be one of "STARTS WITH", "ENDS WITH", "INCLUDES", "REGULAR EXPRESSION"
							</para>
							<para>
								:message_filter_value - &lt;string value to search for&gt;
							</para>
							<para>
								:time_threshold - Options time interval to search. Example: 2.days (Search the past 2 days of event logs) Default 10.days
							</para>
							<para>
								:freq_threshold - Number of occurrences to check for. Default = 2
							</para>
							<para>
								:source, :event_id, :level, :name - Options filter values
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ext_management_system
							</para>
						</entry>
						<entry>
							<para>
								Returns Management System
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								files
							</para>
						</entry>
						<entry>
							<para>
								Returns list of files for the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								guest_applications
							</para>
						</entry>
						<entry>
							<para>
								Returns Guest Applications
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								hardware
							</para>
						</entry>
						<entry>
							<para>
								Returns hardware
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								lans
							</para>
						</entry>
						<entry>
							<para>
								Returns LANs
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								operating_system
							</para>
						</entry>
						<entry>
							<para>
								Returns Operating System
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								storages
							</para>
						</entry>
						<entry>
							<para>
								Returns datastores
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								switches
							</para>
						</entry>
						<entry>
							<para>
								Returns network switches
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								vms
							</para>
						</entry>
						<entry>
							<para>
								Returns VMs.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								credentials(type = :remote)
							</para>
						</entry>
						<entry>
							<para>
								Returns credentials for a Host for the specified type as an array for username/pwd. (Default type is :remote if no type is specified.)
							</para>
							<para>
								Supports 4 different types of credentials:
							</para>
							<para>
								:default = Default
							</para>
							<para>
								:remote = Remote Login (think SSH for ESX)
							</para>
							<para>
								:ws = Web Services
							</para>
							<para>
								:ipmi = IPMI
							</para>
							<para />
							<para>
								Example 1:
							</para>
							<para>
								cred = host.credentials
							</para>
							<para>
								cred =&gt; ["user", "pwd"]
							</para>
							<para />
							<para>
								Example 2:
							</para>
							<para>
								user_str, pwd_str = host.credentials(:ipmi)
							</para>
							<para>
								user_str =&gt; "user"
							</para>
							<para>
								pwd_str =&gt; "pwd"
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_custom_keys
							</para>
						</entry>
						<entry>
							<para>
								Returns Management Systems custom keys
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_custom_get(key)
							</para>
						</entry>
						<entry>
							<para>
								Gets Value for specified Management Systems custom key
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_custom_set(attribute, value)
							</para>
						</entry>
						<entry>
							<para>
								Sets value for specified custom key of the Management System
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_keys
							</para>
						</entry>
						<entry>
							<para>
								Lists CloudForms Management Engine Server custom keys
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_get(key)
							</para>
						</entry>
						<entry>
							<para>
								Gets value for specified CloudForms Management Engine Server custom key
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_set(key, value)
							</para>
						</entry>
						<entry>
							<para>
								Sets value for specified CloudForms Management Engine Server custom key
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ssh_exec(script)
							</para>
						</entry>
						<entry>
							<para>
								Runs the specified script on the host
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_realtime_metric(metric, range, function)
							</para>
						</entry>
						<entry>
							<para>
								Returns specified realtime metric
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								current_memory_usage
							</para>
						</entry>
						<entry>
							<para>
								Returns current memory usage
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								current_cpu_usage
							</para>
						</entry>
						<entry>
							<para>
								Returns current cpu usage
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								current_memory_headroom
							</para>
						</entry>
						<entry>
							<para>
								Returns current memory headroom
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								to_s
							</para>
						</entry>
						<entry>
							<para>
								Converts object to string
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								scan
							</para>
						</entry>
						<entry>
							<para>
								Performs SmartState Analysis on the object
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<para />  
		<para>
			The following table lists the metric types available for the <literal>get_realtime_metric(metric, range, function)</literal> method for hosts.
		</para>
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Metric
							</para>
						</entry>
						<entry>
							<para>
								Description
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								v_derived_storage_used
							</para>
						</entry>
						<entry>
							<para>
								Capacity - Used space in bytes
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								v_pct_cpu_ready_delta_summation
							</para>
						</entry>
						<entry>
							<para>
								CPU - Percentage ready
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								v_pct_cpu_wait_delta_summation
							</para>
						</entry>
						<entry>
							<para>
								CPU - Percentage wait
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								v_pct_cpu_used_delta_summation
							</para>
						</entry>
						<entry>
							<para>
								CPU - Percentage used
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								v_derived_host_count
							</para>
						</entry>
						<entry>
							<para>
								State - Number of hosts (Hourly Count / Daily Average)
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								v_derived_cpu_reserved_pct
							</para>
						</entry>
						<entry>
							<para>
								CPU - Percentage available
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								v_derived_memory_reserved_pct
							</para>
						</entry>
						<entry>
							<para>
								Memory - Percentage available
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<para>
			The following Ruby snippet demonstrates using the <literal>get_realtime_metric(metric, range, function)</literal> method using the <literal>v_pct_cpu_ready_delta_summation</literal> metric.
		</para>
		<programlisting language="Ruby">
host = $evm.root['host']
cpu_rdy = host.get_realtime_metric(:v_pct_cpu_ready_delta_summation, [15.minutes.ago.utc,5.minutes.ago.utc], :avg)
	</programlisting>  
		<programlisting language="Ruby">
<![CDATA[
#########################
  #
  # Method: dumpHost
  # Inputs: $evm.root['host']
  # Description: Dump Host information
  #
  ##########################
  def dumpHost(host)
    host = $evm.object['host'] || $evm.root['host']
    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> Begin Attributes")
    host.attributes.sort.each { |k, v| $evm.log("info", "#{@log_prefix} - Host:<#{host.name}> Attributes - #{k}: #{v.inspect}")}
    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> End Attributes")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> Begin Associations")
    host.associations.sort.each { |assc| $evm.log("info", "#{@log_prefix} - Host:<#{host.name}> Associations - #{assc}")}
    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> End Associations")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> Begin Hardware")
    host.hardware.attributes.each { |k,v| $evm.log("info", "#{@log_prefix} - Host:<#{host.name}> Hardware - #{k}: #{v.inspect}")}
    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> End Hardware")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> Begin Lans")
    host.lans.each { |lan| lan.attributes.sort.each { |k,v| $evm.log("info", "#{@log_prefix} - Host:<#{host.name}> Lan:<#{lan.name}> - #{k}: #{v.inspect}")}}
    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> End Lans")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> Begin Switches")
    host.switches.each { |switch| switch.attributes.sort.each { |k,v| $evm.log("info", "#{@log_prefix} - Host:<#{host.name}> Swtiche:<#{switch.name}> - #{k}: #{v.inspect}")}}
    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> End Switches")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> Begin Operating System")
    host.operating_system.attributes.sort.each { |k, v| $evm.log("info", "#{@log_prefix} - Host:<#{host.name}> Operating System - #{k}: #{v.inspect}")}
    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> End Operating System")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> Begin Guest Applications")
    host.guest_applications.each { |guest_app| guest_app.attributes.sort.each { |k, v| $evm.log("info", "#{@log_prefix} - Host:<#{host.name}> Guest Application:<#{guest_app.name}> - #{k}: #{v.inspect}")}}
    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> End Guest Applications")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> Begin Virtual Columns")
    host.virtual_column_names.sort.each { |vcn| $evm.log("info", "#{@log_prefix} - Host:<#{host.name}> Virtual Columns - #{vcn}: #{host.send(vcn).inspect}")}
    $evm.log("info","#{@log_prefix} - Host:<#{host.name}> End Virtual Columns")
    $evm.log("info", "")
  end
]]>
</programlisting>
		<xi:include href="topics/Hosts_Vmware_ESX_host_vmware_esx.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	</section>
	<xi:include href="topics/LAN_lan.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<section id="sect-Groups_miq_group">
		<title>Groups (miq_group)</title> 
		<para />
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								users
							</para>
						</entry>
						<entry>
							<para>
								Returns users in the current miq_group
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								vms
							</para>
						</entry>
						<entry>
							<para>
								Returns Virtual Machines that this group owns
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_keys
							</para>
						</entry>
						<entry>
							<para>
								Returns all custom keys for the group
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_get(key)
							</para>
						</entry>
						<entry>
							<para>
								Returns the value of the specified custom key for the group
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_set(key, value)
							</para>
						</entry>
						<entry>
							<para>
								Sets the value for the specified key
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<para />  
		<programlisting language="Ruby">
<![CDATA[
  #########################
  #
  # Method: dumpGroup
  # Inputs: $evm.root['user'].miq_group
  # Description: Dump User's Group information
  #
  ##########################
  def dumpGroup
    user = $evm.root['user']
    unless user.nil?
      miq_group = user.miq_group
      unless miq_group.nil?
        $evm.log("info","#{@method} - Group:<#{miq_group.description}> Begin Attributes [miq_group.attributes]")
        miq_group.attributes.sort.each { |k, v| $evm.log("info", "#{@method} - Group:<#{miq_group.description}> Attributes - #{k}: #{v.inspect}")} unless $evm.root['user'].miq_group.nil?
        $evm.log("info","#{@method} - Group:<#{miq_group.description}> End Attributes [miq_group.attributes]")
        $evm.log("info", "")

        $evm.log("info","#{@method} - Group:<#{miq_group.description}> Begin Associations [miq_group.associations]")
        miq_group.associations.sort.each { |assc| $evm.log("info", "#{@method} - Group:<#{miq_group.description}> Associations - #{assc}")}
        $evm.log("info","#{@method} - Group:<#{miq_group.description}> End Associations [miq_group.associations]")
        $evm.log("info","")

        $evm.log("info","#{@method} - Group:<#{miq_group.description}> Begin Virtual Columns [miq_group.virtual_column_names]")
        miq_group.virtual_column_names.sort.each { |vcn| $evm.log("info", "#{@method} - Group:<#{miq_group.description}> Virtual Columns - #{vcn}: #{miq_group.send(vcn).inspect}")}
        $evm.log("info","#{@method} - Group:<#{miq_group.description}> End Virtual Columns [miq_group.virtual_column_names]")
        $evm.log("info","")
      end
    end
  end
]]>
</programlisting>
	</section>
	<section id="sect-Request_miq_request">
		<title>Request (miq_request)</title> 
		<para>
			Request objects are submitted to <productname>CloudForms Management Engine</productname> Server for processing. After the request phase, the request becomes a task object. The table below shows the relationship between a request object and a task object.
		</para>
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Request Object
							</para>
						</entry>
						<entry>
							<para>
								Task Object
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								automation_request
							</para>
						</entry>
						<entry>
							<para>
								automation_task
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								miq_host_provision_request
							</para>
						</entry>
						<entry>
							<para>
								miq_host_provision
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								miq_provision_request
							</para>
						</entry>
						<entry>
							<para>
								miq_provision
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								vm_reconfigure_request
							</para>
						</entry>
						<entry>
							<para>
								vm_reconfigure_task
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								service_template_provision_request
							</para>
						</entry>
						<entry>
							<para>
								service_template_provision_task
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								vm_migrate_request
							</para>
						</entry>
						<entry>
							<para>
								vm_migrate_task
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<para>
			If you set something on the request object, it will be inherited by the task instance that does the work. This may be useful if you are provisioning multiple virtual machines at a time and need to modify the same setting for all. Otherwise, the item can be modified on the individual task.
		</para>
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								add_tag(category, tag_name)
							</para>
						</entry>
						<entry>
							<para>
								Add a tag to a provision instance by specifying the category and tag name
							</para>
							<para>
								Example: miq_provision.add_tag(:location, "CHI")
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								approve(approver,reason for approval)
							</para>
						</entry>
						<entry>
							<para>
								Approves the miq_request.
							</para>
							<para>
								Example: $evm.root["miq_request"].approve("admin", "Auto-Approved")
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								approvers
							</para>
						</entry>
						<entry>
							<para>
								Returns request approvers.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								authorized?
							</para>
						</entry>
						<entry>
							<para>
								Returns true if authorized, false if not.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								clear_tag(category=nil, tag_name=nil)
							</para>
						</entry>
						<entry>
							<para>
								Without any parameters, the clear_tag method will clear all tags from the provision request. Providing a category will clear all tags selected in that category. Clear a specific category/tag by providing it.
							</para>
							<para>
								Example: miq_provision.clear_tag(:location, "CHI")
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								deny
							</para>
						</entry>
						<entry>
							<para>
								Denies the miq_request
							</para>
							<para>
								Example:
							</para>
							<para>
								# Deny the request
							</para>
							<para>
								$evm.log(&apos;info&apos;,"Request denied because of Quota")
							</para>
							<para>
								$evm.root["miq_request"].deny("admin", "Quota Exceeded")
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_classification(category)
							</para>
						</entry>
						<entry>
							<para>
								Works the same as get_tag(category) but the returned data is a hash with :name and :description
							</para>
							<para>
								Example:
							</para>
							<para>
								request.get_classification(:department)
							</para>
							<para>
								Returns: [{:name=&gt;"accounting", :description=&gt;"Accounting"}, {:name=&gt;"engineering", :description=&gt;"Engineering"}]
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_classifications
							</para>
						</entry>
						<entry>
							<para>
								Works the same as get_tag but the returned tag data is a hash with :name and :description
							</para>
							<para>
								Example:
							</para>
							<para>
								request.get_classifications
							</para>
							<para>
								Returns: {:cc=&gt;{:name=&gt;"001", :description=&gt;"Cost Center 001"}, :department=&gt;[{:name=&gt;"accounting", :description=&gt;"Accounting"}, {:name=&gt;"engineering", :description=&gt;"Engineering"}]}
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_option(key)
							</para>
						</entry>
						<entry>
							<para>
								Returns a value from the options hash based on the name of the key name passed in. Internally many of the values are stored as an array of items. (For example, a target host would be stored as the index to the host object in the db and the display name.) Calling this method will return the first item if it is an array. For non-array values the item is returned unmodified.
							</para>
							<para>
								Example: miq_provision_request.get_option(:number_of_cpus)
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_tag(category)
							</para>
						</entry>
						<entry>
							<para>
								Returns the tags selected for the specified tag category.
							</para>
							<para>
								Example: request.get_tag(:department)
							</para>
							<para>
								Returns: ["accounting", "engineering"]
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_tags
							</para>
						</entry>
						<entry>
							<para>
								Get all selected tags stored in a hash by category. If more than one tag is selected in a category, the hash will contain an array of tag names. Otherwise it will contain the tag name as a string.
							</para>
							<para>
								Example: request.get_tags
							</para>
							<para>
								Returns: {:cc=&gt;"001", :department=&gt;["accounting", "engineering"]}
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								miq_request
							</para>
						</entry>
						<entry>
							<para>
								(Legacy support) Internal Note: The miq_request instance use to be a separate instance from the specific request instance (like miq_provision_request). When the classes were refactored into 1 this method was added to allow existing code and automate methods to continue to run unchanged.)
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								miq_request_tasks
							</para>
						</entry>
						<entry>
							<para>
								Returns the requests tasks
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								options
							</para>
						</entry>
						<entry>
							<para>
								Returns a hash containing all the options set for the current provision object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								pending
							</para>
						</entry>
						<entry>
							<para>
								Puts the object in a pending state for approval
							</para>
							<para>
								Example:
							</para>
							<para>
								# Raise automation event: request_pending
							</para>
							<para>
								$evm.root["miq_request"].pending
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								reason
							</para>
						</entry>
						<entry>
							<para>
								Returns reason for approval or denial of request
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								requester
							</para>
						</entry>
						<entry>
							<para>
								Returns the requester
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								resource
							</para>
						</entry>
						<entry>
							<para>
								Returns the resource for the request
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								set_message(value)
							</para>
						</entry>
						<entry>
							<para>
								Sets the message for the request
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								set_option(key, value)
							</para>
						</entry>
						<entry>
							<para>
								Sets the specified key/value pair for the object
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<xi:include href="topics/Automation_request.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
		<xi:include href="topics/Miq_host_provision_request.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
		<xi:include href="topics/Miq_provision_request.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	</section>
	<section id="sect-Request_Task_miq_request_task">
		<title>Request Task (miq_request_task)</title> 
		<para />
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								add_tag(category, tag_name)
							</para>
						</entry>
						<entry>
							<para>
								Add a tag to a provision instance by specifying the category and tag name.
							</para>
							<para>
								Example: miq_provision.add_tag(:location, "CHI")
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								clear_tag(category=nil, tag_name=nil)
							</para>
						</entry>
						<entry>
							<para>
								Without any parameters, the clear_tag method will clear all tags from the provision request. Providing a category will clear all tags selected in that category. Clear a specific category/tag by providing it.
							</para>
							<para>
								Example: miq_provision.clear_tag(:location, "CHI")
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								destination
							</para>
						</entry>
						<entry>
							<para>
								Returns the destination object. (The resultant object from running the task. In the case of provisioning, this would be the newly created VM.)
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								execute
							</para>
						</entry>
						<entry>
							<para>
								Executes or processes the request.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								finished(msg)
							</para>
						</entry>
						<entry>
							<para>
								Sets the task to finished with the supplied message.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_classification(category)
							</para>
						</entry>
						<entry>
							<para>
								Works the same as get_tag(category) but the returned data is a hash with :name and :description.
							</para>
							<para>
								Example:
							</para>
							<para>
								request.get_classification(:department)
							</para>
							<para>
								Returns: [{:name=&gt;"accounting", :description=&gt;"Accounting"}, {:name=&gt;"engineering", :description=&gt;"Engineering"}]
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_classifications
							</para>
						</entry>
						<entry>
							<para>
								Works the same as get_tag but the returned tag data is a hash with :name and :description.
							</para>
							<para>
								Example:
							</para>
							<para>
								request.get_classifications
							</para>
							<para>
								Returns: {:cc=&gt;{:name=&gt;"001", :description=&gt;"Cost Center 001"}, :department=&gt;[{:name=&gt;"accounting", :description=&gt;"Accounting"}, {:name=&gt;"engineering", :description=&gt;"Engineering"}]}
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_option_last(key)
							</para>
						</entry>
						<entry>
							<para>
								This method is the same as get_option, except that it returns the last array value.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_option(key)
							</para>
						</entry>
						<entry>
							<para>
								Returns a value from the options hash based on the name of the key name passed in. Internally many of the values are stored as an array of items. (For example, a target host would be stored as the index to the host object in the db and the display name.) Calling this method will return the first item if it is an array. For non-array values the item is returned unmodified.
							</para>
							<para>
								Example: miq_provision_request.get_option(:number_of_cpus)
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_tag(category)
							</para>
						</entry>
						<entry>
							<para>
								Returns the tags selected for the specified tag category.
							</para>
							<para>
								Example: request.get_tag(:department)
							</para>
							<para>
								Returns: ["accounting", "engineering"]
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_tags
							</para>
						</entry>
						<entry>
							<para>
								Get all selected tags stored in a hash by category. If more than one tag is selected in a category, the hash will contain an array of tag names. Otherwise it will contain the tag name as a string.
							</para>
							<para>
								Example: request.get_tag
							</para>
							<para>
								Returns: {:cc=&gt;"001", :department=&gt;["accounting", "engineering"]}
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								message=(msg)
							</para>
						</entry>
						<entry>
							<para>
								Sets the message for the request task.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								miq_request
							</para>
						</entry>
						<entry>
							<para>
								Returns the miq_request for the task.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								miq_request_task
							</para>
						</entry>
						<entry>
							<para>
								Returns the parent miq_request task.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								miq_request_tasks
							</para>
						</entry>
						<entry>
							<para>
								Returns the children miq_request tasks.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								options
							</para>
						</entry>
						<entry>
							<para>
								Returns a hash containing all the options set for the current object.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								set_option(key, value)
							</para>
						</entry>
						<entry>
							<para>
								Updates a key/value pair in the options hash for the provision object. Often the value is required to be an array.
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								source
							</para>
						</entry>
						<entry>
							<para>
								Returns the source object. (The source, or input, object that the task runs against. In the case of provisioning, this would be the VM or template selected to be provisioned.)
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<xi:include href="topics/Automation_task.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
		<xi:include href="topics/Miq_host_provision.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
		<section id="sect-VM_Provision_Task_miq_provision">
			<title>VM Provision Task (miq_provision)</title> 
			<informaltable frame="all">
				<tgroup cols="2">
					<thead>
						<row>
							<entry>
								<para>
									Method
								</para>
							</entry>
							<entry>
								<para>
									Use
								</para>
							</entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>
								<para>
									check_quota(quota_type, options={})
								</para>
							</entry>
							<entry>
								<para>
									Returns the quota information for the specified type
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_clusters
								</para>
							</entry>
							<entry>
								<para>
									Returns an array of available Cluster objects filtered by previously selected resources
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_customization_templates
								</para>
							</entry>
							<entry>
								<para>
									Returns an array of available Customization Templates
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_folders
								</para>
							</entry>
							<entry>
								<para>
									Returns an array of available Folder objects filtered by previously selected resources
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_hosts
								</para>
							</entry>
							<entry>
								<para>
									Returns an array of available Host objects filtered by previously selected resources
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_iso_images
								</para>
							</entry>
							<entry>
								<para>
									Returns an array of available ISO Image objects filtered by previously selected resources
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_pxe_images
								</para>
							</entry>
							<entry>
								<para>
									Returns an array of available PXE Image objects filtered by previously selected resources
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_pxe_servers
								</para>
							</entry>
							<entry>
								<para>
									Returns an array of available PXE Servers filtered by previously selected resources
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_resource_pools
								</para>
							</entry>
							<entry>
								<para>
									Returns an array of available Resource Pool objects filtered by previously selected resources
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_resources(rsc_type)
								</para>
							</entry>
							<entry>
								<para>
									Returns the eligible resources for the resource type specified
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_storages
								</para>
							</entry>
							<entry>
								<para>
									Returns an array of available Storage (Datastore) objects filtered by previously selected resources
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									eligible_windows_images
								</para>
							</entry>
							<entry>
								<para>
									Returns an array of available Windows Image objects filtered by previously selected resources
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									get_domain_details
								</para>
							</entry>
							<entry>
								<para>
									Returns domain information
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									get_domain_name
								</para>
							</entry>
							<entry>
								<para>
									Returns domain name
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									get_folder_paths
								</para>
							</entry>
							<entry>
								<para>
									Returns a hash where the key is an index and the value is the fully-qualified path name of the folder. (Sample: {7 =&gt; Dev/Dept1/QA, 8 =&gt; Test/Dept2/QA}) This format is useful when a fully-qualified path is required to match the folder name. For example, if you had multiple QA folders under different departments in the sample above. To find the proper QA folder you need to evaluate the entire folder path.
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									get_network_details
								</para>
							</entry>
							<entry>
								<para>
									Returns network information
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									get_network_scope
								</para>
							</entry>
							<entry>
								<para>
									Returns network scope
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									miq_provision_request
								</para>
							</entry>
							<entry>
								<para>
									Returns the provision request object
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_cluster(rsc)
								</para>
							</entry>
							<entry>
								<para>
									Set the cluster to use based on object returned from eligible_clusters
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_customization_spec(name=nil, override=false)
								</para>
							</entry>
							<entry>
								<para>
									Sets the name of the custom spec to use as defined by its name in Virtual Center
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_customization_template(rsc)
								</para>
							</entry>
							<entry>
								<para>
									Set the customization_template to use based on object returned from eligible_customization_templates
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_dvs(portgroup, switch = portgroup)
								</para>
							</entry>
							<entry>
								<para>
									Set the name of the Distributed Virtual Switch (portgroup). An options &lt;switch&gt; name can also be passed
								</para>
								<para>
									Example: miq_provision.set_dvs(&apos;default&apos;)
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_folder(folder_path)
								</para>
							</entry>
							<entry>
								<para>
									Set the folder to use based on object returned from eligible_folders. In addition, set_folder accepts the following folder types:
								</para>
								<para>
									Folder Paths - separated by forward slashes. (Must include Data-center name.) Example: Prod/Discovered virtual machine where Prod is the Data-center name and Discovered virtual machine is the folder name.
								</para>
								<para>
									Object returned from the get_folder_paths method
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_host(rsc)
								</para>
							</entry>
							<entry>
								<para>
									Set the host to use based on object returned from eligible_hosts
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_network_adapter(idx, nic_hash, value=nil)
								</para>
							</entry>
							<entry>
								<para>
									Modifies the network card attached to the VM container
								</para>
								<para>
									Available settings:
								</para>
								<para>
									:is_dvs true / false (Default: false)
								</para>
								<para>
									:network (Network Name)
								</para>
								<para>
									:mac_address
								</para>
								<para>
									:devicetype (Default: VirtualPCNet32) Defined by VMware: http://www.vmware.com/support/developer/vc-sdk/visdk400pubs/ReferenceGuide/vim.vm.device.VirtualEthernetCard.html
								</para>
								<para>
									:connectable =&gt; {:allowguestcontrol =&gt; true / false} (Default: true)
								</para>
								<para>
									:connectable =&gt; {:startconnected =&gt; true / false} (Default: true)
								</para>
								<para>
									:connectable =&gt; {:connected =&gt; true / false} (Default: true)
								</para>
								<para />
								<para>
									Example: prov.set_network_adapter(1, {:network =&gt; dvs_net1, :is_dvs =&gt; true} )
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_network_address_mode(mode)
								</para>
							</entry>
							<entry>
								<para>
									Available modes are dhcp and static
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_nic_settings(idx, nic_hash, value=nil)
								</para>
							</entry>
							<entry>
								<para>
									Modifies the network interface settings at the operating system level
								</para>
								<para>
									Available settings:
								</para>
								<para>
									:addr_mode "dhcp" / "static" (Default: Statis)
								</para>
								<para>
									:ip_addr
								</para>
								<para>
									:subnet_mask
								</para>
								<para>
									:gateway
								</para>
								<para>
									:dns_domain
								</para>
								<para>
									:dns_servers (Windows Only) Comma separated values
								</para>
								<para>
									:sysprep_netbios_mode (Windows Only) Defined by VMware: http://www.vmware.com/support/developer/vc-sdk/visdk400pubs/ReferenceGuide/vim.vm.customization.IPSettings.NetBIOSMode.html
								</para>
								<para>
									:wins_servers Passed as a string specifying the Primary and Secondary WINS servers separated by a comma. "&lt;PrimaryWINS&gt;, &lt;SecondaryWINS&gt;"
								</para>
								<para>
									Example: prov.set_nic_settings(1, {:ip_addr=&gt;10.226.133.55, :subnet_mask=&gt;&apos;255.255.255.192&apos;, :gateway=&gt;&apos;10.226.133.5&apos;, :addr_mode=&gt;["static", "Static"] } )
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_iso_image(rsc)
								</para>
							</entry>
							<entry>
								<para>
									Set the iso_image to use based on object returned from eligible_iso_images
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_pxe_image(rsc)
								</para>
							</entry>
							<entry>
								<para>
									Set the pxe_image to use based on object returned from eligible_pxe_images
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_pxe_server(rsc)
								</para>
							</entry>
							<entry>
								<para>
									Set the pxe_server to use based on object returned from eligible_pxe_servers
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_resource_pool(rsc)
								</para>
							</entry>
							<entry>
								<para>
									Set the resource_pool to use based on object returned from eligible_resource_pools
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_storage(rsc)
								</para>
							</entry>
							<entry>
								<para>
									Set the Datastore (storage object) to use based on object returned from eligible_storages
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_vlan(vlan)
								</para>
							</entry>
							<entry>
								<para>
									Sets the name of the VLan to use
								</para>
								<para>
									Example: miq_provision.set_vlan(&apos;default&apos;)
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_vm_notes(note)
								</para>
							</entry>
							<entry>
								<para>
									Sets text for the VM notes (aka annotation) field
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_vm_notes(notes)
								</para>
							</entry>
							<entry>
								<para>
									Sets text for the VM notes (aka annotation) field
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									set_windows_image(rsc)
								</para>
							</entry>
							<entry>
								<para>
									Set the windows_image to use based on object returned from eligible_windows_images
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									source_type
								</para>
							</entry>
							<entry>
								<para>
									Returns the provision source type. (values are &apos;vm&apos; or &apos;template&apos;)
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									status
								</para>
							</entry>
							<entry>
								<para>
									Returns provision status
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									target_type
								</para>
							</entry>
							<entry>
								<para>
									Returns the provision target type. (values are &apos;vm&apos; or &apos;template&apos;)
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									vdi_farm
								</para>
							</entry>
							<entry>
								<para>
									Returns VDI Farm information
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									vm
								</para>
							</entry>
							<entry>
								<para>
									The newly created vm
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									vm_template
								</para>
							</entry>
							<entry>
								<para>
									Returns the template selected to be provisioned
								</para>
							</entry>
						</row>
					</tbody>
				</tgroup>
			</informaltable>  
			<programlisting language="Ruby">
<![CDATA[
begin
  miq_provision = $evm.root["miq_provision"] || $evm.root['miq_provision']
  prov = $evm.root["miq_provision"]
  user = prov.miq_request.requester
  raise "User not specified" if user.nil?



  ###################################
  # Process Change Request Number and set VM Annotation
  ###################################
  intake = prov.get_option(:vm_description)
  intake = "Change Request#: #{intake}"
  prov.set_option(:vm_description,intake)


  ###################################
  # Set the customization spec based on the environment tag chosen in the dialog
  ###################################
  tags = prov.get_tags
  $evm.log("info","Tags: #{tags.inspect}")
  env = tags[:environment]
  $evm.log("info", "Mapping custom spec based on Category Environment <#{env}> chosen in the dialog")
  if env.eql? "dev"
    customization_spec = "Dev-Specification"
    miq_provision.set_customization_spec(customization_spec)
  end
  if env.eql? "stg"
    customization_spec = "Stg-Specification"
    miq_provision.set_customization_spec(customization_spec)
  end


  ###################################
  # Set the VM Notes as follows:
  ###################################
  vm_notes = "#{intake}"
  vm_notes +=  "\nOwner: #{miq_provision.get_option(:owner_first_name)} #{miq_provision.get_option(:owner_last_name)}"
  vm_notes += "\nEmail: #{miq_provision.get_option(:owner_email)}"
  vm_notes += "\nSource Template: #{miq_provision.vm_template.name}"
  miq_provision.set_vm_notes(vm_notes)


  ###################################
  # Drop the VM in the targeted folder
  # In VC a folder must exist that matches the LDAP Group
  # VM will be placed in the Folder
  ###################################
  if prov.get_option(:placement_folder_name).nil?
    ###################################
    # If you want to use a Default folder, set folder = below to the default
    ###################################
    #    folder = "22F DC/LAB FARM/GSE/Intel/Infrastructure/ManageIQ/SelfServiceVMs"
    folder = "DC1/Infrastructure/ManageIQ/SelfService"
    $evm.log("info", "Placing VM in VC folder: <#{folder}")
    $evm.log("info", "Set_folder called with [#{folder.inspect}]")

    miq_provision.set_folder(folder)
  end


  ####################################################
  # Set the IP Address based on the :mac_address entered in the dialog
  #
  ####################################################
  ipaddr = prov.get_option(:mac_address)

  if ! ipaddr.nil?
    # Set provisioning options to override options
    prov.set_option(:sysprep_spec_override, [true, 1])
    prov.set_option(:addr_mode, ["static", "Static"])
    prov.set_option(:ip_addr, ipaddr)
    # Reset :mac_address to nil
    prov.set_option(:mac_address, nil)
  end

  $evm.log("info", "Provision Options: #{prov.options.inspect}")

  exit MIQ_OK

rescue => err
  $evm.log("info", "Set_folder err [#{err}]\n#{err.backtrace.join("\n")}")
end
]]>
</programlisting>
			<xi:include href="topics/Adding_Disks_to_OpenStack_Instance_Provisioning.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
			<xi:include href="topics/Booting_OpenStack_Instances_from_Volume.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
			<xi:include href="topics/VM_Provisioning_for_Clouds_Task_miq_provision_cloud.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
		</section>
		<xi:include href="topics/Service_template_provision_task.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
		<xi:include href="topics/Service_Reconfiguration_Task_service_reconfigure_task.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
		<xi:include href="topics/Vm_migrate_task.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	</section>
	<xi:include href="topics/Proxies_miq_proxy.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<section id="sect-Servers_miq_server">
		<title>Servers (miq_server)</title> 
		<para />
		<para>
			These methods are available to the <productname>CloudForms Management Engine</productname> Server.
		</para>
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								zone
							</para>
						</entry>
						<entry>
							<para>
								Returns <productname>CloudForms Management Engine</productname> Servers Zone
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								region_number
							</para>
						</entry>
						<entry>
							<para>
								Returns <productname>CloudForms Management Engine</productname> Servers Region Number
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								region_name
							</para>
						</entry>
						<entry>
							<para>
								Returns <productname>CloudForms Management Engine</productname> Servers Region Name
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<para />  
		<programlisting language="Ruby">
<![CDATA[
  #########################
  #
  # Method: dumpServer
  # Inputs: $evm.root['miq_server']
  # Description: Dump MIQ Server information
  #
  ##########################
  def dumpServer
    $evm.log("info","#{@method} - Server:<#{$evm.root['miq_server'].name}> Begin Attributes")
    $evm.root['miq_server'].attributes.sort.each { |k, v| $evm.log("info", "#{@method} - Server:<#{$evm.root['miq_server'].name}> Attributes - #{k}: #{v.inspect}")}
    $evm.log("info","#{@method} - Server:<#{$evm.root['miq_server'].name}> End Attributes")
    $evm.log("info", "")
  end
]]>
</programlisting>
	</section>
	<xi:include href="topics/Network_network.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Pxe_image.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Pxe_server.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Security_Groups_security_group.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Service2.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Service_Resource_service_resource.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Service_Template.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<xi:include href="topics/Snapshot_snapshot.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<section id="sect-Datastores_storage">
		<title>Datastores (storage)</title> 
		<para />
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								ext_management_systems,
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Management System
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								hosts
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Hosts
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								vms
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Virtual Machines
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								unregistered_vms
							</para>
						</entry>
						<entry>
							<para>
								Returns objects unregistered Virtual Machines
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								to_s
							</para>
						</entry>
						<entry>
							<para>
								Converts object to string
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								scan
							</para>
						</entry>
						<entry>
							<para>
								Performs SmartState Analysis on the object
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<para />  
		<programlisting language="Ruby">
<![CDATA[
 #########################
  #
  # Method: dumpStorage
  # Inputs: $evm.root['storage']
  # Description: Dump Storage information
  #
  ##########################
  def dumpStorage(storage)
    $evm.log("info","#{@log_prefix} - Storage:<#{storage.name}> Begin Attributes")
    storage.attributes.sort.each { |k, v| $evm.log("info", "#{@log_prefix} - Storage:<#{storage.name}> Attributes - #{k}: #{v.inspect}")}
    $evm.log("info","#{@log_prefix} - Storage:<#{storage.name}> End Attributes")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Storage:<#{storage.name}> Begin Associations")
    storage.associations.sort.each { |assc| $evm.log("info", "#{@log_prefix} - Storage:<#{storage.name}> Associations - #{assc}")}
    $evm.log("info","#{@log_prefix} - Storage:<#{storage.name}> End Associations")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - Storage:<#{storage.name}> Begin Virtual Columns")
    storage.virtual_column_names.sort.each { |vcn| $evm.log("info", "#{@log_prefix} - Storage:<#{storage.name}> Virtual Columns - #{vcn}: #{storage.send(vcn)}")}
    $evm.log("info","#{@log_prefix} - Storage:<#{storage.name}> End Virtual Columns")
    $evm.log("info","")
  end
]]>
</programlisting>
	</section>
	<xi:include href="topics/Switch_switch.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<section id="sect-User_user">
		<title>User (user)</title> 
		<para />
		<para>
			These methods can be used on the currently logged on user.
		</para>
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								current_group
							</para>
						</entry>
						<entry>
							<para>
								Returns user's assigned internal group
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_get(key)
							</para>
						</entry>
						<entry>
							<para>
								Returns the custom key value specified by "key"
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_keys
							</para>
						</entry>
						<entry>
							<para>
								Returns an array of custom keys
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_set(key,value)
							</para>
						</entry>
						<entry>
							<para>
								Sets custom value for "key" to "value"
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								email
							</para>
						</entry>
						<entry>
							<para>
								Returns user's email address
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_ladap_attribute(name)
							</para>
						</entry>
						<entry>
							<para>
								Returns the value of the specified LDAP attribute
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_ldap_atttribute_names
							</para>
						</entry>
						<entry>
							<para>
								Returns user's LDAP attribute names
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ldap_group
							</para>
						</entry>
						<entry>
							<para>
								Returns user's assigned LDAP group
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								miq_requests
							</para>
						</entry>
						<entry>
							<para>
								Returns user's requests
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								name
							</para>
						</entry>
						<entry>
							<para>
								Returns user's name
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								userid
							</para>
						</entry>
						<entry>
							<para>
								Returns user's userid
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								vms
							</para>
						</entry>
						<entry>
							<para>
								Returns Virtual Machines that this user owns
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<para />  
		<programlisting language="Ruby">
<![CDATA[
  #########################
  #
  # Method: dumpUser
  # Inputs: $evm.root['user']
  # Description: Dump User information
  #
  ##########################
  def dumpUser
    user = $evm.root['user']
    unless user.nil?
      $evm.log("info","#{@method} - User:<#{user.name}> Begin Attributes [user.attributes]")
      user.attributes.sort.each { |k, v| $evm.log("info", "#{@method} - User:<#{user.name}> Attributes - #{k}: #{v.inspect}")}
      $evm.log("info","#{@method} - User:<#{user.name}> End Attributes [user.attributes]")
      $evm.log("info", "")

      $evm.log("info","#{@method} - User:<#{user.name}> Begin Associations [user.associations]")
      user.associations.sort.each { |assc| $evm.log("info", "#{@method} - User:<#{user.name}> Associations - #{assc}")}
      $evm.log("info","#{@method} - User:<#{user.name}> End Associations [user.associations]")
      $evm.log("info","")

      $evm.log("info","#{@method} - User:<#{user.name}> Begin Virtual Columns [user.virtual_column_names]")
      user.virtual_column_names.sort.each { |vcn| $evm.log("info", "#{@method} - User:<#{user.name}> Virtual Columns - #{vcn}: #{user.send(vcn).inspect}")}
      $evm.log("info","#{@method} - User:<#{user.name}> End Virtual Columns [user.virtual_column_names]")
      $evm.log("info","")
    end
  end
]]>
</programlisting>
	</section>
	<section id="sect-Virtual_Machines_and_Templates_vm_or_template">
		<title>Virtual Machines and Templates (vm_or_template)</title> 
		<para>
			The following methods can be used on a virtual machine or template object.
		</para>
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								changed_vm_value?
							</para>
						</entry>
						<entry>
							<para>
								Checks the 2 most recent drift state captures , and answers whether the specified value changed between them
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								collect_running_processes
							</para>
						</entry>
						<entry>
							<para>
								Collects the running processes of the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								create_snapshot(name, desc = nil)
							</para>
						</entry>
						<entry>
							<para>
								Create a snapshot of the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_get(key)
							</para>
						</entry>
						<entry>
							<para>
								Get the value of specified <productname>CloudForms Management Engine</productname> Server key from the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_keys
							</para>
						</entry>
						<entry>
							<para>
								List all <productname>CloudForms Management Engine</productname> Server custom keys for the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								custom_set(key, value)
							</para>
						</entry>
						<entry>
							<para>
								Set a custom <productname>CloudForms Management Engine</productname> Server key value
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								datacenter
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Datacenter
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								direct_service
							</para>
						</entry>
						<entry>
							<para>
								Show the direct service relationship of the virtual machine
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								directories
							</para>
						</entry>
						<entry>
							<para>
								Returns number of directories on the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_blue_folder (this will be reworked to be more VMware-specific)
							</para>
						</entry>
						<entry>
							<para>
								Returns objects blue folder from VMware. These are the folders showing in VM and Templates view in VMware
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_cluster
							</para>
						</entry>
						<entry>
							<para>
								Returns objects cluster
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_custom_get(key)
							</para>
						</entry>
						<entry>
							<para>
								Gets specified key of custom Management System Attribute
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_custom_keys
							</para>
						</entry>
						<entry>
							<para>
								List the custom keys defined by the Management System for the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_custom_set(attribute, value)
							</para>
						</entry>
						<entry>
							<para>
								Sets specified key and value of custom Management System Attribute
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_folder
							</para>
						</entry>
						<entry>
							<para>
								Returns objects folder on Management System
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ems_ref_string
							</para>
						</entry>
						<entry>
							<para>
								Returns unique identifier the Management System uses to identify this resource. For example, in VMware a VM would return a value like: "vm-26622"
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								event_log_threshold? (options)
							</para>
						</entry>
						<entry>
							<para>
								Searches event log records to determine if an event has occurred x number of times within a defined time frame. Returns true if the number of matching records found are greater or equal to the specified freq_threshold, otherwise it returns false
							</para>
							<para>
								Options values:
							</para>
							<para>
								:message_filter_type - Must be one of "STARTS WITH", "ENDS WITH", "INCLUDES", "REGULAR EXPRESSION"
							</para>
							<para>
								:message_filter_value - &lt;string value to search for&gt;
							</para>
							<para>
								:time_threshold - Options time interval to search. Example: 2.days (Search the past 2 days of event logs) Default 10.days
							</para>
							<para>
								:freq_threshold - Number of occurrences to check for. Default = 2
							</para>
							<para>
								:source, :event_id, :level, :name - Options filter values
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								event_threshold?(options)
							</para>
						</entry>
						<entry>
							<para>
								Checks if an event (or multiple events) have occurred X number of times in N seconds. The values below are used if no data is passed
							</para>
							<para>
								event_threshold?(options = {:time_threshold =&gt; 30.minutes, :event_types =&gt; ["MigrateVM_Task_Complete"], :freq_threshold =&gt; 2})
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								ext_management_system
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Management System
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								files
							</para>
						</entry>
						<entry>
							<para>
								Returns number of files on the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								get_realtime_metric(metric, range, function)
							</para>
						</entry>
						<entry>
							<para>
								Returns specified realtime metric
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								group=(group)
							</para>
						</entry>
						<entry>
							<para>
								Sets objects group
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								guest_applications
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Guest Application list
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								hardware
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Hardware
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								host
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Host
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								migrate(host, pool = nil, priority = "defaultPriority", state = nil)
							</para>
						</entry>
						<entry>
							<para>
								Migrates the object to another host. The only required parameter is host
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								miq_provision
							</para>
						</entry>
						<entry>
							<para>
								If VM was created using <productname>CloudForms Management Engine</productname> Server provisioning, this is the miq_provision task instance that created the VM
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								operating_system
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Operating System
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								owner
							</para>
						</entry>
						<entry>
							<para>
								Return objects owner
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								owner=(owner)
							</para>
						</entry>
						<entry>
							<para>
								Sets objects owner
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								performances_maintains_value_for_duration?
							</para>
						</entry>
						<entry>
							<para>
								Based on options given, checks to see if a performance threshold is maintained for a time period
							</para>
							<para>
								Example: vm.performances_maintains_value_for_duration?(:column =&gt; "cpu_usage_rate_average", :operator =&gt; "=", :value =&gt; 3.51, :duration =&gt; 20.minutes)
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								reboot_guest
							</para>
						</entry>
						<entry>
							<para>
								Reboots the guest operating system
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								reconfigured_hardware_value?
							</para>
						</entry>
						<entry>
							<para>
								Checks if hardware value has been reconfigured
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								refresh
							</para>
						</entry>
						<entry>
							<para>
								Refresh power states and relationships of the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								registered?
							</para>
						</entry>
						<entry>
							<para>
								Is the object registered?
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								remove_all_snapshots
							</para>
						</entry>
						<entry>
							<para>
								Remove all of the objects snapshots
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								remove_from_disk
							</para>
						</entry>
						<entry>
							<para>
								Removes the object from disk
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								remove_from_vmdb
							</para>
						</entry>
						<entry>
							<para>
								Removes the object from the VMDB
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								remove_snapshot(snapshot_id)
							</para>
						</entry>
						<entry>
							<para>
								Remove a specific snapshot based on the snapshot_id
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								resource_pool
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Resource Pool
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								retire_now
							</para>
						</entry>
						<entry>
							<para>
								Retire the object immediately
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								retirement_warn=(seconds)
							</para>
						</entry>
						<entry>
							<para>
								Send a retirement warning
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								retires_on=(date)
							</para>
						</entry>
						<entry>
							<para>
								Retire the object on date specified
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								revert_to_snapshot(snapshot_id)
							</para>
						</entry>
						<entry>
							<para>
								Revert to a snapshot based on the snapshot_id
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								scan(scan_categories = nil)
							</para>
						</entry>
						<entry>
							<para>
								Perform SmartState Analysis on the object. Scan_categories is optional
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								service
							</para>
						</entry>
						<entry>
							<para>
								Show the top-level service for a virtual machine in a service hierarchy. For the immediate parent service relationship of a virtual machine, use direct_service
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								shutdownGuest
							</para>
						</entry>
						<entry>
							<para>
								Shuts down the guest operating system of the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								snapshots
							</para>
						</entry>
						<entry>
							<para>
								Returns list of snapshots for the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								standby_guest
							</para>
						</entry>
						<entry>
							<para>
								Puts the operating system on standby
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								start
							</para>
						</entry>
						<entry>
							<para>
								Starts the object
							</para>
							<para>
								See Samples/PowerOn_DHOB
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								stop
							</para>
						</entry>
						<entry>
							<para>
								Stops the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								storage
							</para>
						</entry>
						<entry>
							<para>
								Returns objects Datastore
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								suspend
							</para>
						</entry>
						<entry>
							<para>
								Suspends the object
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								to_s
							</para>
						</entry>
						<entry>
							<para>
								Converts object to string
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								unlink_storage
							</para>
						</entry>
						<entry>
							<para>
								Removes the reference to the VM&apos;s Datastore
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								unregister
							</para>
						</entry>
						<entry>
							<para>
								Unregisters the object from the Management System
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<para />  
		<programlisting language="Ruby">
<![CDATA[
#########################
  #
  # Method: dumpVM
  # Inputs: $evm.root['vm']
  # Description: Dump VM information
  #
  ##########################
  def dumpVM(vm)
    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin Attributes [vm.attributes]")
    vm.attributes.sort.each { |k, v| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> Attributes - #{k}: #{v.inspect}")}
    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End Attributes [vm.attributes]")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin Associations [vm.associations]")
    vm.associations.sort.each { |assc| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> Associations - #{assc}")}
    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End Associations [vm.associations]")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin Hardware Attributes [vm.hardware]")
    vm.hardware.attributes.each { |k,v| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> Hardware - #{k}: #{v.inspect}")}
    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End Hardware Attributes [vm.hardware]")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin Hardware Associations [vm.hardware.associations]")
    vm.hardware.associations.sort.each { |assc| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> hardware Associations - #{assc}")}
    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End hardware Associations [vm.hardware.associations]")
    $evm.log("info","")

    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin Neworks [vm.hardware.nics]")
    vm.hardware.nics.each { |nic| nic.attributes.sort.each { |k,v| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> VLAN:<#{nic.device_name}> - #{k}: #{v.inspect}")}}
    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End Networks [vm.hardware.nics]")
    $evm.log("info","")

    unless vm.ext_management_system.nil?
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin EMS [vm.ext_management_system]")
      vm.ext_management_system.attributes.sort.each { |ems_k, ems_v| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> EMS:<#{vm.ext_management_system.name}> #{ems_k} - #{ems_v.inspect}")}
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End EMS [vm.ext_management_system]")
      $evm.log("info","")
    end

    unless vm.owner.nil?
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin Owner [vm.owner]")
      vm.owner.attributes.each { |k,v| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> Owner - #{k}: #{v.inspect}")}
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End Owner [vm.owner]")
      $evm.log("info","")
    end

    unless vm.operating_system.nil?
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin Operating System [vm.operating_system]")
      vm.operating_system.attributes.sort.each { |k, v| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> Operating System - #{k}: #{v.inspect}")}
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End Operating System [vm.operating_system]")
      $evm.log("info","")
    end

    unless vm.guest_applications.nil?
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin Guest Applications")
      vm.guest_applications.each { |guest_app| guest_app.attributes.sort.each { |k, v| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> Guest Application:<#{guest_app.name}> - #{k}: #{v.inspect}")}} unless vm.guest_applications.nil?
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End Guest Applications")
      $evm.log("info","")
    end

    unless vm.snapshots.nil?
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin Snapshots")
      vm.snapshots.each { |ss| ss.attributes.sort.each { |k, v| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> Snapshot:<#{ss.name}> - #{k}: #{v.inspect}")}} unless vm.snapshots.nil?
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End Snapshots")
      $evm.log("info","")
    end

    unless vm.storage.nil?
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin VM Storage [vm.storage]")
      vm.storage.attributes.sort.each { |stor_k, stor_v| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> Storage:<#{vm.storage.name}> #{stor_k} - #{stor_v.inspect}")}
      $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End VM Storage [vm.storage]")
      $evm.log("info","")
    end

    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> Begin Virtual Columns -----")
    vm.virtual_column_names.sort.each { |vcn| $evm.log("info", "#{@log_prefix} - VM:<#{vm.name}> Virtual Columns - #{vcn}: #{vm.send(vcn).inspect}")}
    $evm.log("info","#{@log_prefix} - VM:<#{vm.name}> End Virtual Columns -----")
    $evm.log("info","")
  end
]]>
</programlisting>  
		<programlisting language="Ruby">
<![CDATA[
####################
 #
 # Method: createSnapshot
 #
 ####################
 def createSnapshot(vm, snap_name, snap_desc=snap_name)
  $evm.log("info","#{@method} - VM:<#{vm.name}> Creating Snapshot:<#{snap_name}> Description:<#{snap_desc}>")
  vm.create_snapshot(snap_name, snap_desc)
 end
]]>
</programlisting>
		<section id="sect-VMs_vm">
			<title>VMs (vm)</title> 
			<informaltable frame="all">
				<tgroup cols="2">
					<colspec colname="c1" colnum="1" />
					<colspec colname="c2" colnum="2" />
					<thead>
						<row>
							<entry>
								<para>
									Method
								</para>
							</entry>
							<entry>
								<para>
									Use
								</para>
							</entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>
								<para>
									add_to_service(service)
								</para>
							</entry>
							<entry>
								<para>
									Adds the VM to a service object
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									remove_from_service
								</para>
							</entry>
							<entry>
								<para>
									Removes the VM from its parent service
								</para>
							</entry>
						</row>
					</tbody>
				</tgroup>
			</informaltable>  
			<para>
				The following table lists the metric types available for the <literal>get_realtime_metric(metric, range, function)</literal> method for virtual machines.
			</para>
			<informaltable frame="all">
				<tgroup cols="2">
					<thead>
						<row>
							<entry>
								<para>
									Metric
								</para>
							</entry>
							<entry>
								<para>
									Description
								</para>
							</entry>
						</row>
					</thead>
					<tbody>
						<row>
							<entry>
								<para>
									v_derived_storage_used
								</para>
							</entry>
							<entry>
								<para>
									Capacity - Used space in bytes
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									v_pct_cpu_ready_delta_summation
								</para>
							</entry>
							<entry>
								<para>
									CPU - Percentage ready
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									v_pct_cpu_wait_delta_summation
								</para>
							</entry>
							<entry>
								<para>
									CPU - Percentage wait
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									v_pct_cpu_used_delta_summation
								</para>
							</entry>
							<entry>
								<para>
									CPU - Percentage used
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									v_derived_vm_count
								</para>
							</entry>
							<entry>
								<para>
									State - Peak average virtual machines (Hourly Count / Daily Average)
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									v_derived_cpu_reserved_pct
								</para>
							</entry>
							<entry>
								<para>
									CPU - Percentage available
								</para>
							</entry>
						</row>
						<row>
							<entry>
								<para>
									v_derived_memory_reserved_pct
								</para>
							</entry>
							<entry>
								<para>
									Memory - Percentage available
								</para>
							</entry>
						</row>
					</tbody>
				</tgroup>
			</informaltable>
			<para>
				The following Ruby snippet demonstrates using the <literal>get_realtime_metric(metric, range, function)</literal> method using the <literal>v_pct_cpu_ready_delta_summation</literal> metric.
			</para>
			<programlisting language="Ruby">
host = $evm.root['vm']
cpu_rdy = vm.get_realtime_metric(:v_pct_cpu_ready_delta_summation, [15.minutes.ago.utc,5.minutes.ago.utc], :avg)
	</programlisting>
			<xi:include href="topics/VMs_for_Clouds_vm_cloud.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
		</section>
	</section>
	<xi:include href="topics/Windows_image.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	<section id="sect-Creating_Categories_and_Tags">
		<title>Creating Categories and Tags</title> 
		<para>
			These methods are invoked using $evm.execute. See after the table for usage examples.
		</para>
		<informaltable frame="all">
			<tgroup cols="2">
				<thead>
					<row>
						<entry>
							<para>
								Method(<emphasis>parameter</emphasis>)
							</para>
						</entry>
						<entry>
							<para>
								Use
							</para>
						</entry>
					</row>
				</thead>
				<tbody>
					<row>
						<entry>
							<para>
								category_exists?
							</para>
						</entry>
						<entry>
							<para>
								Checks to see if a tag category exists. Usually used with unless or if to then create a category that does not exist.
							</para>
							<para>
								Example: $evm.execute(&apos;category_exists?&apos;, "department")
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								category_create
							</para>
						</entry>
						<entry>
							<para>
								Creates a new category and sets if only one tag value from this category can be assigned to a configuration item (using the single_value option).
							</para>
							<para>
								Example: $evm.execute(&apos;category_create&apos;, :name =&gt; "department", :single_value =&gt; false, :description =&gt; "Department")
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								tag_exists?
							</para>
						</entry>
						<entry>
							<para>
								Checks to see if a tag exists in a category.
							</para>
							<para>
								Example: $evm.execute(tag_exists?&apos;, "department", finance)
							</para>
						</entry>
					</row>
					<row>
						<entry>
							<para>
								tag_create
							</para>
						</entry>
						<entry>
							<para>
								Creates a new tag in the specified category.
							</para>
							<para>
								Example: $evm.execute(tag_create&apos;, "department", :name =&gt; "finance", :description =&gt; "Finance")
							</para>
						</entry>
					</row>
				</tbody>
			</tgroup>
		</informaltable>
		<para />
		<para />
		<xi:include href="topics/Category_and_Tags_Methods_Example1.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
	</section>
	<xi:include href="topics/Quota2.xml" xmlns:xi="http://www.w3.org/2001/XInclude" />
</chapter>