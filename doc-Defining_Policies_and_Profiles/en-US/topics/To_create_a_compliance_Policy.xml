<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE section PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "../Defining_Policies_and_Profiles.ent">
%BOOK_ENTITIES;
]>
<section id="To_create_a_compliance_Policy" remap="TID_14772">
	<title>Creating a Compliance Policy</title>
	<para>
		Create compliance policies by assigning or creating a condition. <productname>CloudForms Management Engine</productname> automatically assigns the events and actions to the compliance policy as opposed to a control policy where you must define this yourself. The VM or host compliance check event is assigned to the compliance policy. A compliance policy runs the mark as compliant action when the virtual machine or host passes all of the conditions. If any of the conditions are not met, then the virtual machine or host is marked as non-compliant.
	</para>
	<para>
		If you do not know how to create a condition, see <xref linkend="Creating_a_new_Policy_Condition" />. Carefully plan the purpose of your policy before creating it. You can also use a scope expression that is tested immediately when the compliance check event triggers the policy. If the item is out of scope, then the policy does not continue on to the conditions, and none of the associated actions run.
	</para> 
	<!--	<para>
		In the procedure below, you will create a policy that checks to see if a virtual machine has required patches, but you could also create a similar policy for hosts. If the patches are installed, the virtual machine will be marked as compliant. If not, then it will be marked as non-compliant. This policy assumes that you already have created the conditions that you want to check. For this example, we are checking for security patches.
	</para> -->
	<procedure>
		<title>To Create a Compliance Policy</title>
		<step>
			<para>
				Navigate to <menuchoice><guimenu>Control</guimenu><guisubmenu>Explorer</guisubmenu></menuchoice>.
			</para>
		</step>
		<step>
			<para>
				Click on the <guimenuitem>Policies</guimenuitem> accordion, and select VM or host compliances policies.
			</para>
		</step>
		<step>
			<para>
				Click 
				<inlinemediaobject>
					<imageobject>
						<imagedata fileref="images/1847.png" />
					</imageobject>
				</inlinemediaobject> (<guilabel>Configuration</guilabel>), 
				<inlinemediaobject>
					<imageobject>
						<imagedata fileref="images/1848.png" />
					</imageobject>
				</inlinemediaobject> (<guilabel>Add a new Compliance Policy</guilabel>).
			</para>
		</step>
		<step>
			<para>
				Type in a <guilabel>Description</guilabel> for the policy.
			</para>
			<mediaobject>
				<imageobject>
					<imagedata align="center" fileref="images/1935.png" />
				</imageobject>
			</mediaobject>
		</step>
		<step>
			<para>
				Uncheck <guilabel>Active</guilabel> if you do not want this policy processed even when assigned to a resource.
			</para>
		</step>
		<step>
			<para>
				You can enter a scope here. (You can also create a scope as part of a condition, or not use one at all.) If the host or virtual machine is not included in the scope, NO actions run.
			</para>
		</step>
		<step>
			<para>
				In the <guilabel>Notes</guilabel> area, add a detailed explanation of the policy.
			</para>
		</step>
		<step>
			<para>
				Click <guibutton>Add</guibutton>.
			</para>
		</step>
		<step>
			<para>
				Click 
				<inlinemediaobject>
					<imageobject>
						<imagedata fileref="images/1847.png" />
					</imageobject>
				</inlinemediaobject> (<guilabel>Configuration</guilabel>), 
				<inlinemediaobject>
					<imageobject>
						<imagedata fileref="images/1875.png" />
					</imageobject>
				</inlinemediaobject> (<guilabel>Edit this Policy's Condition assignments</guilabel>).
			</para>
		</step>
		<step>
			<para>
				Select the required conditions from the <guilabel>Available Conditions</guilabel> box. Use the <keycap>Ctrl</keycap> key to select multiple actions.
			</para>
			<mediaobject>
				<imageobject>
					<imagedata align="center" fileref="images/1934.png" />
				</imageobject>
			</mediaobject>
		</step>
		<step>
			<para>
				Click 
				<inlinemediaobject>
					<imageobject>
						<imagedata fileref="images/1876.png" />
					</imageobject>
				</inlinemediaobject> (<guilabel>Move selected Conditions into this Policy</guilabel>).
			</para>
		</step>
		<step>
			<para>
				Click <guibutton>Save</guibutton>. By default, if ANY of the conditions are false, the virtual machine is marked as non-compliant.
			</para>
		</step>
		<step>
			<para>
				To add other actions, such as sending an email if the virtual machine fails the compliance test, click <guimenuitem>VM Compliance Check</guimenuitem>.
			</para>
		</step>
		<step>
			<para>
				Click 
				<inlinemediaobject>
					<imageobject>
						<imagedata fileref="images/1847.png" />
					</imageobject>
				</inlinemediaobject> (<guilabel>Configuration</guilabel>), 
				<inlinemediaobject>
					<imageobject>
						<imagedata fileref="images/1881.png" />
					</imageobject>
				</inlinemediaobject> (<guilabel>Edit Actions for this Policy Event</guilabel>).
			</para>
		</step>
		<step>
			<para>
				Select <guimenuitem>Stop Virtual Machine</guimenuitem> and <guimenuitem>Send Email</guimenuitem> from the <guilabel>Available Actions</guilabel> area in <guilabel>Order of Actions if ANY conditions are False</guilabel>. (<guimenuitem>Mark as Non-Compliant</guimenuitem> should already be selected.)
			</para>
			<mediaobject>
				<imageobject>
					<imagedata align="center" fileref="images/1933.png" />
				</imageobject>
			</mediaobject>
		</step>
		<step>
			<para>
				Click 
				<inlinemediaobject>
					<imageobject>
						<imagedata fileref="images/1876.png" />
					</imageobject>
				</inlinemediaobject> (<guilabel>Move selected Actions into this Event</guilabel>).
			</para>
		</step>
		<step>
			<para>
				Click <guibutton>Add</guibutton>.
			</para>
		</step>
	</procedure>
	<para>
		You can now make this part of a policy profile. After assigning the policy profile to the virtual machine, you can check it for its compliance status either on a schedule or on demand.
	</para>
</section>